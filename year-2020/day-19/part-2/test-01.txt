--input--
0: 4 1 5
1: 3 | 3 1
3: 4 5 | 5 4
4: "a"
5: "b"

aabb
abab
aaaa
bbbb
aabababb
aabbab

--output--
4